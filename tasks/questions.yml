---

- name: Initialiizing default variables
  set_fact:
    defaults: '{{ defaults|default({}) }}'
    forceask: '{{ forceask|default(false) }}'
    validation: '{{ validation|default({}) }}'

- name: Setting facts from rolevars
  set_fact: {'{{ rolevar.key }}': '{{ rolevar.value }}'}
  with_dict: '{{ ansible_facts.ansible_local.get(rolename|as_fact_name, {}) }}'
  loop_control:
    loop_var: rolevar

- name: Iterating over role variables for questions etc
  include: question.yml
  with_dict: '{{ questions }}'
  loop_control:
    loop_var: question
  when: |
    (
      '_'.join(question.key.split('_')[:-1]) + '_enable' not in questions
      or question.key.endswith('_enable')
      or (
        hostvars[inventory_hostname].get('_'.join(question.key.split('_')[:-1]) + '_enable')
        and hostvars[inventory_hostname].get('_'.join(question.key.split('_')[:-1]) + '_enable')
      )
    )
